/* © Clarify Cloud Limited 2013, 2014
All Rights Reserved
No part of this material or any of its contents may be reproduced, copied, modified or adapted, without prior written consent from Clarify Cloud Limited.
*/
var rData=new RowData();var rdLog=new RowDataLog();var rdLogArray=new LogRowingData();var cData=new Constraints();var gData=new Geoloc();var geolocAccuracy=50;var dataItem={};dataItem.appVers="0.5.5";dataItem.Piece_Id="initial";dataItem.Session_Id="initial";dataItem.TP_Id="initial";var statusItem={};var setting={};var userId={};var altConstaint=null;var intervalConstraint=null;statusItem.baseURL_1="http://rowsagetest.cloudapp.net:3000";statusItem.baseURL_2="http://rowcatchertest.cloudapp.net:3000";statusItem.baseURL_ls="192.168.1.100";statusItem.baseURL_3="http://"+statusItem.baseURL_ls+":3000";statusItem.freqCollection_1=1000;statusItem.freqCollection_2=2000;statusItem.freqCollection_4=4000;statusItem.freqCollection_6=6000;statusItem.freqCollection_8=8000;statusItem.freqCollection_10=10000;statusItem.freqCollection=statusItem.freqCollection_4;statusItem.daysToKeep=21;statusItem.paddleTimeLimit=3*60*60*1000;statusItem.developer=false;statusItem.txEnabled=true;statusItem.pieceState="READY";statusItem.onStartPage=true;statusItem.sendTimeout=15000;statusItem.pieceFinishedDataSend=false;statusItem.updateSessionTimer=5*60000;statusItem.demoUser=false;var saveToW=false;var stateConnection1=false;var TimeHours=$("#TimeHrs");var TimeMins=$("#TimeMins");var TimeSecs=$("#TimeSecs");var TimeHrsInterval=$("#TimeHrsInterval");var TimeMinsInterval=$("#TimeMinsInterval");var TimeSecsInterval=$("#TimeSecsInterval");var RepeatTime=$("#RepeatTime");var TimeHrsRest=$("#TimeHrsRest");var TimeMinsRest=$("#TimeMinsRest");var TimeSecsRest=$("#TimeSecsRest");var DistHrsRest=$("#DistHrsRest");var DistMinsRest=$("#DistMinsRest");var DistSecsRest=$("#DistSecsRest");var DisInterval=$("#DisInterval");var DisRepeat=$("#DisRepeat");var StrokeInterval=$("#StrokeInterval");var StrokeRepeat=$("#StrokeRepeat");var StrokeRest=$("#StrokeRest");var DistanceM=$("#DisM");var TgtHR=$("#HrTgt");var TgtStk=$("#SrtTgt");function setInitialPieceValues(){TgtHR.val(100);TgtStk.val(90);DistanceM.val(1000);DisInterval.val(2000);TimeHours.val(0);TimeMins.val(5);TimeSecs.val(0);TimeHrsInterval.val(0);TimeMinsInterval.val(4);TimeSecsInterval.val(0);RepeatTime.val(2);TimeHrsRest.val(0);TimeMinsRest.val(1);TimeSecsRest.val(0);DistHrsRest.val(0);DistMinsRest.val(1);DistSecsRest.val(0);DisInterval.val(1000);DisRepeat.val(2);StrokeInterval.val(20);StrokeRepeat.val(2);StrokeRest.val(10)}setInitialPieceValues();function setDemoPieceValues(){TgtHR.val(100);TgtStk.val(90);TimeHours.val(0);TimeMins.val(1);TimeSecs.val(25);DistanceM.val(390);DisInterval.val(150);TimeHrsInterval.val(0);TimeMinsInterval.val(4);TimeSecsInterval.val(0);RepeatTime.val(2);TimeHrsRest.val(0);TimeMinsRest.val(1);TimeSecsRest.val(0);DistHrsRest.val(0);DistMinsRest.val(0);DistSecsRest.val(30);DisRepeat.val(2);StrokeInterval.val(15);StrokeRepeat.val(2);StrokeRest.val(9)}var hoursTimedPiece,minsTimedPiece,secsTimedPiece;var hoursIntervalPiece,minsIntervalPiece,secsIntervalPiece,repeatTime;var hoursRestPiece,minsRestPiece,secsRestPiece;var hoursDistPiece,minsDistPiece,secsDistPiece,distRest;var hrTarget,stkTarget;var distInterval;var strokeInterval,strokeRepeat,strokeRest;var developer=true;var silentmode=true;function setPhoneSessionValues(){hoursTimedPiece=TimeHours.val();minsTimedPiece=TimeMins.val();secsTimedPiece=TimeSecs.val();hoursIntervalPiece=TimeHrsInterval.val();minsIntervalPiece=TimeMinsInterval.val();secsIntervalPiece=TimeSecsInterval.val();repeatTime=RepeatTime.val();hoursRestPiece=TimeHrsRest.val();minsRestPiece=TimeMinsRest.val();secsRestPiece=TimeSecsRest.val();hoursDistPiece=DistHrsRest.val();minsDistPiece=DistMinsRest.val();secsDistPiece=DistSecsRest.val();distRest=DisRepeat.val();distInterval=DisInterval.val();strokeInterval=StrokeInterval.val();strokeRepeat=StrokeRepeat.val();strokeRest=StrokeRest.val();pieceDistanceSelected=DistanceM.val();hrTarget=TgtHR.val();stkTarget=TgtStk.val()}setPhoneSessionValues();var ref;if(silentmode==true){$("#flipswitchBeep").slider();$("#flipswitchBeep").val("true").slider("refresh")}else{$("#flipswitchBeep").slider();$("#flipswitchBeep").val("false").slider("refresh")}silentmode=$("#flipswitchBeep").val();$(document).ready(function(){var c=$.jStorage.get("lst");if(c){if(typeof c.email!="undefined"){$("#emailUser").val(c.email)}}else{$("#emailUser").val("")}$("#versionno").text("App Version  :\t\t"+dataItem.appVers);$("#bluetoothpage").on("click",function(){var n=device.platform;if(n!="Win32NT"){$.mobile.changePage("#regBluetooth",{transition:"none",reverse:true,changeHash:true})}else{$.mobile.showPageLoadingMsg("b","HeartRate Belt not Supported ...",true);setTimeout(function(){$.mobile.hidePageLoadingMsg()},1000)}});$("#goToSettings").on("click",function(){$.mobile.changePage("#settings",{transition:"none",reverse:true,changeHash:true})});$("#checkStorage").on("click",function(){var o=$.jStorage.storageSize();$("#storagevalue").text(o+"bytes used");var n=device.platform;if(n=="iOS"){o=(o/2500000)*100}else{o=(o/5000000)*100}$("#storageUsed").progressbar({value:o});setTimeout(function(){$("#storagevalue").text("")},2000)});$("#flipswitch").on("change",function(){var n=$("#flipswitch").val();if(n=="true"){$(".developer").show()}else{$(".developer").hide()}});function j(){setting=$.jStorage.get("setingKey");if(!setting){setting={};setting.Server=statusItem.baseURL_1;setting.IP=statusItem.baseURL_ls;$("#HostIP").val(setting.IP);var n=0.3;setting.proportionOfIdealAcceptableAsFitness=n;setting.Freq=statusItem.freqCollection_4;$.jStorage.set("setingKey",setting);b();d();f();m(1);$("#settings").page();$("#accelSetting1").slider().val(setting.proportionOfIdealAcceptableAsFitness);$("#accelSetting1").slider("refresh")}}j();function b(){setting=$.jStorage.get("setingKey");if(!setting.Server){setting.Server=statusItem.baseURL_1;$.jStorage.set("setingKey",setting)}if(!setting.IP){setting.IP=statusItem.baseURL_ls;$("#HostIP").val(setting.IP);$.jStorage.set("setingKey",setting)}}function m(n){if(n==3){$("#server3").checkboxradio();$("#server3").prop("checked",true).checkboxradio("refresh");$("#server2").checkboxradio();$("#server2").prop("checked",false).checkboxradio("refresh");$("#server1").checkboxradio();$("#server1").prop("checked",false).checkboxradio("refresh");statusItem.baseURL=statusItem.baseURL_3}else{if(n==2){$("#server3").checkboxradio();$("#server3").prop("checked",false).checkboxradio("refresh");$("#server2").checkboxradio();$("#server2").prop("checked",true).checkboxradio("refresh");$("#server1").checkboxradio();$("#server1").prop("checked",false).checkboxradio("refresh");statusItem.baseURL=statusItem.baseURL_2}else{$("#server3").checkboxradio();$("#server3").prop("checked",false).checkboxradio("refresh");$("#server2").checkboxradio();$("#server2").prop("checked",false).checkboxradio("refresh");$("#server1").checkboxradio();$("#server1").prop("checked",true).checkboxradio("refresh");statusItem.baseURL=statusItem.baseURL_1}}statusItem.regURL=statusItem.baseURL+"/ShortRegister.html";statusItem.updateURL=statusItem.baseURL+"/EditProfile.html";statusItem.resultURL=statusItem.baseURL+"/PieceDetailChart.html";l()}m(1);statusItem.regURL=statusItem.baseURL+"/ShortRegister.html";statusItem.updateURL=statusItem.baseURL+"/EditProfile.html";statusItem.resultURL=statusItem.baseURL+"/PieceDetailChart.html";function l(){}function h(o,n){statusItem.baseURL=o;$("#settings").page();if(o==statusItem.baseURL_1){$("#server1").prop("checked",true).checkboxradio("refresh")}else{if(o==statusItem.baseURL_2){$("#server2").prop("checked",true).checkboxradio("refresh")}else{$("#server3").prop("checked",true).checkboxradio("refresh");$("#HostIP").val(n)}}}function d(){$("#settings").page();$("#time1").prop("checked",false).checkboxradio("refresh");$("#time2").prop("checked",false).checkboxradio("refresh");$("#time4").prop("checked",false).checkboxradio("refresh");$("#time6").prop("checked",false).checkboxradio("refresh");$("#time8").prop("checked",false).checkboxradio("refresh");$("#time10").prop("checked",false).checkboxradio("refresh")}function g(n){d();statusItem.freqCollection=n;$("#settings").page();if(n==statusItem.freqCollection_1){statusItem.freqCollection=statusItem.freqCollection_1;$("#time1").prop("checked",true).checkboxradio("refresh")}else{if(n==statusItem.freqCollection_2){statusItem.freqCollection=statusItem.freqCollection_2;$("#time2").prop("checked",true).checkboxradio("refresh")}else{if(n==statusItem.freqCollection_4){statusItem.freqCollection=statusItem.freqCollection_4;$("#time4").prop("checked",true).checkboxradio("refresh")}else{if(n==statusItem.freqCollection_6){statusItem.freqCollection=statusItem.freqCollection_6;$("#time6").prop("checked",true).checkboxradio("refresh")}else{if(n==statusItem.freqCollection_8){statusItem.freqCollection=statusItem.freqCollection_8;$("#time8").prop("checked",true).checkboxradio("refresh")}else{if(n==statusItem.freqCollection_10){statusItem.freqCollection=statusItem.freqCollection_10;$("#time10").prop("checked",true).checkboxradio("refresh")}else{statusItem.freqCollection=statusItem.freqCollection_4;$("#time10").prop("checked",true).checkboxradio("refresh")}}}}}}}function f(){setting=$.jStorage.get("setingKey");if(setting.Freq!=null){g(setting.Freq)}else{setting.Freq=statusItem.freqCollection_4;$.jStorage.set("setingKey",setting);setting=$.jStorage.get("setingKey");g(setting.Freq)}}f();$("#hideExit").hide();$("#iframeregister").show();$("#inappbrowser").on("click",function(){var n="http://rowcatcher.com/EditProfile.html";ref=window.open(n,"_blank","location=yes")});$("#updateprofile").on("click",function(){var n=statusItem.baseURL+"/ShortRegister.html";ref=window.open(n,"_blank","location=yes")});$("#iframeupdatemsg").show();$(document).delegate("#updatepage","pageshow",function(){$.mobile.showPageLoadingMsg("b","Loading ...");$.mobile.loadPage("#updatepage",{prefetch:"true"});$("#iframeupdate").attr("src",statusItem.updateURL).attr("height","500px").attr("width","100%")});$(document).delegate("#resultwebpage","pageshow",function(){$.mobile.showPageLoadingMsg("b","Loading ...");$("#webresult").attr("src",statusItem.resultURL).attr("height","590px").attr("width","95%")});$(document).delegate("#resultwebpage","pagehide",function(){});$(document).delegate("#startpage","pageshow",function(){statusItem.onStartPage=true;statusItem.demoUser=false;setInitialPieceValues();setPhoneSessionValues()});$(document).delegate("#startpage","pagehide",function(){statusItem.onStartPage=false});$("#iframereg").load(function(){$("#iframeregister").hide();$.mobile.hidePageLoadingMsg()});$("#iframeupdate").load(function(){$("#iframeupdatemsg").hide();$.mobile.hidePageLoadingMsg()});$("#webresult").load(function(){$.mobile.hidePageLoadingMsg()});$(document).delegate("#settings","pageshow",function(){b()});$(document).delegate("#results","pageshow",function(){if(dataItem.UsrType=="Reg"){txData.displayLocalStorage()}else{$("#storageList").children().remove();if(navigator.notification){navigator.notification.alert("To see Results you will need to register\n",i,"Notice","Ok")}else{alert("To see Results you will need to register")}}});$(document).delegate("#mySession","pageshow",function(){var o=e();var p=txData.connectionState();if(o&&p){if(dataItem.UsrType!="UnReg"){if(navigator.notification){navigator.notification.confirm("You have data to send to web \n(Data Older than 7 days will be Deleted from the Phone)",a,"Sync to WEB ?",["Later","Send Now"])}else{var n=confirm("Send Data Now");if(n){a(2)}else{a(1)}}}}txData.deleteOldEntries()});function e(){var p=false;var n=txData.checkForStatus();for(var o=0;o<n.length;o++){if(n[o].Save==true){p=false}else{p=true;break}}return p}function a(o){if(o==2){var n=txData.connectionState();if(n){if(navigator.notification){navigator.notification.alert("Sending Data",i,"Notice","Ok")}else{alert("Sending Data")}txData.syncToWeb()}else{if(navigator.notification){navigator.notification.alert("You Are OffLine Try Again Later...",i,"Notice","Ok")}else{alert("You Are OffLine Try Again Later...")}}}}$("input:radio[name=server]").click(function(){var o=$(this).val();if(o=="server1"){statusItem.baseURL=statusItem.baseURL_1}else{if(o=="server2"){statusItem.baseURL=statusItem.baseURL_2}else{if(o=="server3"){var n=$("#HostIP").val();if(n){statusItem.baseURL_ls=$("#HostIP").val()}statusItem.baseURL="http://"+statusItem.baseURL_ls+":3000"}}}statusItem.regURL=statusItem.baseURL+"/ShortRegister.html";statusItem.updateURL=statusItem.baseURL+"/EditProfile.html";statusItem.resultURL=statusItem.baseURL+"/PieceDetailChart.html";setting.Server=statusItem.baseURL;setting.IP=statusItem.baseURL_ls;$.jStorage.set("setingKey",setting)});$("#restart").on("click",function(){setting.Server=statusItem.baseURL;setting.IP=statusItem.baseURL_ls;$.jStorage.set("setingKey",setting)});$("#flipswitchBeep").on("change",function(){silentmode=$("#flipswitchBeep").val()});$("input:radio[name=freqDataCollect]").click(function(){var n=$(this).val();if(n=="time1"){statusItem.freqCollection=statusItem.freqCollection_1}else{if(n=="time2"){statusItem.freqCollection=statusItem.freqCollection_2}else{if(n=="time4"){statusItem.freqCollection=statusItem.freqCollection_4}else{if(n=="time6"){statusItem.freqCollection=statusItem.freqCollection_6}else{if(n=="time8"){statusItem.freqCollection=statusItem.freqCollection_8}else{if(n=="time10"){statusItem.freqCollection=statusItem.freqCollection_10}}}}}}setting.Freq=statusItem.freqCollection;$.jStorage.set("setingKey",setting);f()});$("input:radio[name=BsaveToWeb]").click(function(){var n=$(this).val();if(n=="yes"){saveToW=true}else{if(n=="no"){saveToW=false}}});$(".closeDialog").on("touchstart click",function(n){n.stopPropagation();n.preventDefault();$(".ui-dialog").dialog("close")});$("#HrsUp").on("click",function(){setPhoneSessionValues();if(hoursTimedPiece<0){hoursTimedPiece=0}else{hoursTimedPiece++;TimeHours.val(hoursTimedPiece)}});$("#HrsDwn").on("click",function(){setPhoneSessionValues();if(hoursTimedPiece==0){hoursTimedPiece=0}else{hoursTimedPiece--;TimeHours.val(hoursTimedPiece)}});$("#MinsUp").on("click",function(){setPhoneSessionValues();if(minsTimedPiece>=59){hoursTimedPiece++;TimeHours.val(hoursTimedPiece);minsTimedPiece=0;TimeMins.val(minsTimedPiece)}else{minsTimedPiece++;TimeMins.val(minsTimedPiece)}});$("#MinsDwn").on("click",function(){setPhoneSessionValues();if(minsTimedPiece==0){if(hoursTimedPiece!=0){hoursTimedPiece--;TimeHours.val(hoursTimedPiece)}minsTimedPiece=59;TimeMins.val(minsTimedPiece)}else{minsTimedPiece--;TimeMins.val(minsTimedPiece)}});$("#SecsUp").on("click",function(){setPhoneSessionValues();if(secsTimedPiece>=59){if(minsTimedPiece>=59){hoursTimedPiece++;TimeHours.val(hoursTimedPiece);minsTimedPiece=0;TimeMins.val(minsTimedPiece);secsTimedPiece=0;TimeSecs.val(secsTimedPiece)}else{minsTimedPiece++;TimeMins.val(minsTimedPiece);secsTimedPiece=0;TimeSecs.val(secsTimedPiece)}}else{secsTimedPiece++;TimeSecs.val(secsTimedPiece)}});$("#SecsDwn").on("click",function(){setPhoneSessionValues();if(secsTimedPiece==0){if(minsTimedPiece==0){if(hoursTimedPiece>=1){hoursTimedPiece--;TimeHours.val(hoursTimedPiece)}else{hoursTimedPiece=0;TimeHours.val(hoursTimedPiece)}minsTimedPiece=59;TimeMins.val(minsTimedPiece);secsTimedPiece=59;TimeSecs.val(secsTimedPiece)}else{minsTimedPiece--;TimeMins.val(minsTimedPiece);secsTimedPiece=59;TimeSecs.val(secsTimedPiece)}}else{secsTimedPiece--;TimeSecs.val(secsTimedPiece)}});$("#HrsUpInterval").on("click",function(){setPhoneSessionValues();if(hoursIntervalPiece<0){hoursIntervalPiece=0;TimeHrsInterval.val(hoursIntervalPiece)}else{hoursIntervalPiece++;TimeHrsInterval.val(hoursIntervalPiece)}});$("#HrsDwnInterval").on("click",function(){setPhoneSessionValues();if(hoursIntervalPiece==0){hoursIntervalPiece=0;TimeHrsInterval.val(hoursIntervalPiece)}else{hoursIntervalPiece--;TimeHrsInterval.val(hoursIntervalPiece)}});$("#MinsUpInterval").on("click",function(){setPhoneSessionValues();if(minsIntervalPiece>=59){hoursIntervalPiece++;TimeHrsInterval.val(hoursIntervalPiece);minsIntervalPiece=0;TimeMinsInterval.val(minsIntervalPiece)}else{minsIntervalPiece++;TimeMinsInterval.val(minsIntervalPiece)}});$("#MinsDwnInterval").on("click",function(){setPhoneSessionValues();if(minsIntervalPiece==0){if(hoursIntervalPiece!=0){hoursIntervalPiece--;TimeHrsInterval.val(hoursIntervalPiece)}minsIntervalPiece=59;TimeMinsInterval.val(minsIntervalPiece)}else{minsIntervalPiece--;TimeMinsInterval.val(minsIntervalPiece)}});$("#SecsUpInterval").on("click",function(){setPhoneSessionValues();if(secsIntervalPiece>=59){if(minsIntervalPiece>=59){hoursIntervalPiece++;TimeHrsInterval.val(hoursIntervalPiece);minsIntervalPiece=0;TimeMinsInterval.val(minsIntervalPiece);secsIntervalPiece=0;TimeSecsInterval.val(secsIntervalPiece)}else{minsIntervalPiece++;TimeMinsInterval.val(minsIntervalPiece);secsIntervalPiece=0;TimeSecsInterval.val(secsIntervalPiece)}}else{secsIntervalPiece++;TimeSecsInterval.val(secsIntervalPiece)}});$("#SecsDwnInterval").on("click",function(){setPhoneSessionValues();if(secsIntervalPiece==0){if(minsIntervalPiece==0){if(hoursIntervalPiece>=1){hoursIntervalPiece--;TimeHrsInterval.val(hoursIntervalPiece)}else{hoursIntervalPiece=0;TimeHrsInterval.val(hoursIntervalPiece)}minsIntervalPiece=59;TimeMinsInterval.val(minsIntervalPiece);secsIntervalPiece=59;TimeSecsInterval.val(secsIntervalPiece)}else{minsIntervalPiece--;TimeMinsInterval.val(minsIntervalPiece);secsIntervalPiece=59;TimeSecsInterval.val(secsIntervalPiece)}}else{secsIntervalPiece--;TimeSecsInterval.val(secsIntervalPiece)}});$("#HrsUpRest").on("click",function(){setPhoneSessionValues();if(hoursRestPiece<0){hoursRestPiece=0}else{hoursRestPiece++;TimeHrsRest.val(hoursRestPiece)}});$("#HrsDwnRest").on("click",function(){setPhoneSessionValues();if(hoursRestPiece<=0){hoursRestPiece=0}else{hoursRestPiece--;TimeHrsRest.val(hoursRestPiece)}});$("#MinsUpRest").on("click",function(){setPhoneSessionValues();if(minsRestPiece>=59){hoursRestPiece++;TimeHrsRest.val(hoursRestPiece);minsRestPiece=0;TimeMinsRest.val(minsRestPiece)}else{minsRestPiece++;TimeMinsRest.val(minsRestPiece)}});$("#MinsDwnRest").on("click",function(){setPhoneSessionValues();if(minsRestPiece==0){if(hoursRestPiece!=0){hoursRestPiece--;TimeHrsRest.val(hoursRestPiece)}minsRestPiece=59;TimeMinsRest.val(minsRestPiece)}else{minsRestPiece--;TimeMinsRest.val(minsRestPiece)}});$("#SecsUpRest").on("click",function(){setPhoneSessionValues();if(secsRestPiece>=59){if(minsRestPiece>=59){hoursRestPiece++;TimeHrsRest.val(hoursRestPiece);minsRestPiece=0;TimeMinsRest.val(minsRestPiece);secsRestPiece=0;TimeSecsRest.val(secsRestPiece)}else{minsRestPiece++;TimeMinsRest.val(minsRestPiece);secsRestPiece=0;TimeSecsRest.val(secsRestPiece)}}else{secsRestPiece++;TimeSecsRest.val(secsRestPiece)}});$("#SecsDwnRest").on("click",function(){setPhoneSessionValues();if(secsRestPiece==0){if(minsRestPiece==0){if(hoursRestPiece>=1){hoursRestPiece--;TimeHrsRest.val(hoursRestPiece)}else{hoursRestPiece=0;TimeHrsRest.val(hoursRestPiece)}minsRestPiece=59;TimeMinsRest.val(minsRestPiece);secsRestPiece=59;TimeSecsRest.val(secsRestPiece)}else{minsRestPiece--;TimeMinsRest.val(minsRestPiece);secsRestPiece=59;TimeSecsRest.val(secsRestPiece)}}else{secsRestPiece--;TimeSecsRest.val(secsRestPiece)}});$("#HrsUpDistRest").on("click",function(){setPhoneSessionValues();if(hoursDistPiece<0){hoursDistPiece=0;DistHrsRest.val(hoursDistPiece)}else{hoursDistPiece++;DistHrsRest.val(hoursDistPiece)}});$("#HrsDwnDistRest").on("click",function(){if(hoursDistPiece==0){hoursDistPiece=0;DistHrsRest.val(hoursDistPiece)}else{hoursDistPiece--;DistHrsRest.val(hoursDistPiece)}});$("#MinsUpDistRest").on("click",function(){setPhoneSessionValues();if(minsDistPiece>=59){hoursDistPiece++;DistHrsRest.val(hoursDistPiece);minsDistPiece=0;DistMinsRest.val(minsDistPiece)}else{minsDistPiece++;DistMinsRest.val(minsDistPiece)}});$("#MinsDwnDistRest").on("click",function(){setPhoneSessionValues();if(minsDistPiece==0){if(hoursDistPiece!=0){hoursDistPiece--;DistHrsRest.val(hoursDistPiece)}minsDistPiece=59;DistMinsRest.val(minsDistPiece)}else{minsDistPiece--;DistMinsRest.val(minsDistPiece)}});$("#SecsUpDistRest").on("click",function(){setPhoneSessionValues();if(secsDistPiece>=59){if(minsDistPiece>=59){hoursDistPiece++;DistHrsRest.val(hoursDistPiece);minsDistPiece=0;DistMinsRest.val(minsDistPiece);secsDistPiece=0;DistSecsRest.val(secsDistPiece)}else{minsDistPiece++;DistMinsRest.val(minsDistPiece);secsDistPiece=0;DistSecsRest.val(secsDistPiece)}}else{secsDistPiece++;DistSecsRest.val(secsDistPiece)}});$("#SecsDwnDistRest").on("click",function(){hoursDistPiece=DistHrsRest.val();minsDistPiece=DistMinsRest.val();secsDistPiece=DistSecsRest.val();setPhoneSessionValues();if(secsDistPiece==0){if(minsDistPiece==0){if(hoursDistPiece>=1){hoursDistPiece--;DistHrsRest.val(hoursDistPiece)}else{hoursDistPiece=0;DistHrsRest.val(hoursDistPiece)}minsDistPiece=59;DistMinsRest.val(minsDistPiece);secsDistPiece=59;DistSecsRest.val(secsDistPiece)}else{minsDistPiece--;DistMinsRest.val(minsDistPiece);secsDistPiece=59;DistSecsRest.val(secsDistPiece)}}else{secsDistPiece--;DistSecsRest.val(secsDistPiece)}});function k(o,n){if(o<n){o=n}return o}$("#TimeCreatePiece").on("click",function(){$("#createPieces").children().trigger("collapse")});$("#DistCreatePiece").on("click",function(){$("#createPieces").children().trigger("collapse")});$("#TimeICreatePiece").on("click",function(){$("#createPieces").children().trigger("collapse")});$("#DistICreatePiece").on("click",function(){$("#createPieces").children().trigger("collapse")});$("#StrokeICreatePiece").on("click",function(){$("#createPieces").children().trigger("collapse")});$("#RepeatTime").on("change",function(){repeatTime=RepeatTime.val();var n=k(repeatTime,1);RepeatTime.val(n)});$("#DisInterval").on("change",function(){distInterval=DisInterval.val();var n=k(distInterval,1);DisInterval.val(n)});$("#DisRepeat").on("change",function(){distRest=DisRepeat.val();var n=k(distRest,1);DisRepeat.val(n);distRest=DisRepeat.val()});$("#StrokeInterval").on("change",function(){strokeInterval=StrokeInterval.val();var n=k(strokeInterval,5);StrokeInterval.val(n);strokeInterval=StrokeInterval.val()});$("#StrokeRepeat").on("change",function(){strokeRepeat=StrokeRepeat.val();var n=k(strokeRepeat,1);StrokeRepeat.val(n);strokeRepeat=StrokeRepeat.val()});$("#StrokeRest").on("change",function(){strokeRest=StrokeRest.val();var n=k(strokeRest,5);StrokeRest.val(n);strokeRest=StrokeRest.val()});$("#Targetdata").on("click",function(){hrTarget=TgtHR.val();stkTarget=TgtStk.val();$("#pieceTargets").children().trigger("collapse")});$("#HrTgt").on("change",function(){hrTarget=TgtHR.val();var n=k(hrTarget,0);TgtHR.val(n);hrTarget=TgtHR.val()});$("#SrtTgt").on("change",function(){stkTarget=TgtStk.val();var n=k(stkTarget,1);TgtStk.val(n);stkTarget=TgtStk.val()});$("#DisM").on("change",function(){pieceDistanceSelected=DistanceM.val();var n=k(pieceDistanceSelected,0);DistanceM.val(n);pieceDistanceSelected=DistanceM.val()});$("#eraseStorage").on("click",function(){if(typeof prompt!="undefined"){var n=prompt("Enter Password");if(n=="flush"){var o=confirm("Erase All Data  ?")}else{if(navigator.notification){navigator.notification.alert("Incorrect Password",i,"Notice","Ok")}else{alert("Sorry Incorrect Password")}}if(o){$.jStorage.flush();j()}}else{var p=confirm("Are You Sure ?");if(p){$.jStorage.flush();j()}}});function i(){}});(function(aG){var o=10000;aG(document).delegate("#dashboard","pageshow",function(){aG("#quotap").text("");aG("#quotad").text("");txData.connectionState();if(typeof device!="undefined"){var l=device.platform;window.plugins.insomnia.keepAwake()}intervalConstraint=setInterval(function(){var ba={};var a5=cData.getPieceType();if((a5==0)||(a5==1)||(a5==2)){ba.time=rData.getPieceTimeTotal()/1000;ba.meters=rData.getPieceDistanceTotal();ba.strokes=rData.getPieceStrokeCountTotal()}else{ba.time=rData.getIntervalTimeTotal()/1000;ba.meters=rData.getIntervalDistanceTotal();ba.strokes=rData.getIntervalStrokeCountTotal()}cData.setDataNow(ba);var a8=cData.getAtlConstraint();if(a8){var a7=cData.isDailyLimitReached(a8);var a6=cData.isPieceLimitReached(a8);var a9;if(a6){if((a5==0)||(a5==1)||(a5==2)){rData.setGuiEvent("PEND")}else{rData.setGuiEvent("IEND")}a9=cData.getPieceDiveq();statusItem.pieceState="STOP";dataItem.paID=0;rData.setPAID(dataItem.paID);aW(a9);clearInterval(intervalConstraint);aG("#quotamsg").text("");aG("#popupquota").popup();aG("#popupquota").popup("open")}else{if(a7){aG("#proceedquota").hide();if((a5==0)||(a5==1)||(a5==2)){rData.setGuiEvent("PEND")}else{rData.setGuiEvent("IEND")}a9=cData.getPieceDiveq();statusItem.pieceState="STOP";dataItem.paID=0;rData.setPAID(dataItem.paID);aW(a9);clearInterval(intervalConstraint);aG("#quotamsg").text("");aG("#popupquota").popup();aG("#popupquota").popup("open")}}}},o)});aG(document).delegate("#dashboard","pagehide",function(){clearInterval(intervalConstraint);if(window.plugins){window.plugins.insomnia.allowSleepAgain()}});aG(document).delegate("#controlPage","pageshow",function(){if(window.plugins){window.plugins.insomnia.keepAwake()}});aG(document).delegate("#controlPage","pagehide",function(){if(window.plugins){window.plugins.insomnia.allowSleepAgain()}});function f(){}function aq(l){}function a0(l){}function q(){}function x(){}aG("#democonstraints").on("click",function(){cData.checkSameDay();var a5=cData.getDemoHtml();aG("#constraintmsg").html(a5);aG("#demouser").show();aG("#subscribeduser").hide();var l=cData.getDefaultQuota();cData.setAtlConstraint(l);aG("#session_div").empty();aG("#controlBtns").empty();statusItem.demoUser=true;var a6=aC();an(a6)});aG("#resetconstraints").on("click",function(){aQ();aG.mobile.changePage("#startpage",{transition:"slideup",reverse:true,changeHash:true})});function aQ(){aG.jStorage.deleteKey("constraint");cData.setNewBalance()}aG("#goDashBoard").on("click",function(){aG.mobile.changePage("#dashboard",{transition:"slideup",reverse:true,changeHash:true});aD()});aG("#LimitedFunctionality").on("click",function(){dataItem.emailUsr="UnRegistered";dataItem.UsrType="UnReg";rData.setUserEM(dataItem.emailUsr);rData.setUserID(0)});function L(l){if(l){aG(".developer").hide();aG("#flipswitch").slider();aG("#flipswitch").val("off").slider("refresh");aG("#developerdisplay").show()}else{aG(".developer").hide();aG("#developerdisplay").hide()}}function aC(){var a9=new Date();var ba=a9.getFullYear(),a5=a9.getUTCMonth()+1,be=+a9.getDate();var a8=a9.getHours(),bd=a9.getMinutes(),bb=a9.getSeconds();var a7=aj(a8,bd,bb);var bc=ba+"-"+a5+"-"+be;var l={};l._id="Phone";l.RegisterID="initial";l.TP_Name="Phone Favorites";l.TP_Description="";l.TP_AssignUsers="user assigned number";l.Session_ID="12345";l.S_Name="Favorites";l.S_Description="";l.S_Time=a7;l.S_TotalDuration="";l.S_Mode="";l.S_TrainingZone="";l.S_ModeBName="";l.S_ModeBType="";var bf={_id:l._id,RegisterID:l.RegisterID,TP_Name:l.TP_Name,TP_Description:l.TP_Description,TP_AssignUsers:[l.TP_AssignUsers],PlannedSession:[{Session_ID:l.Session_ID,S_Name:"Favorites",S_Description:"",S_Date:bc,S_Time:l.S_Time,S_TotalDuration:l.S_TotalDuration,S_Mode:l.S_Mode,S_TrainingZone:l.S_TrainingZone,S_ModeBName:l.S_ModeBName,S_ModeBType:l.S_ModeBType,Piece:b()}]};var a6=[];a6.push(bf);return a6}function b(){var a8={};var bc=[];var a9=aj(hoursTimedPiece,minsTimedPiece,secsTimedPiece);var l=aj(hoursIntervalPiece,minsIntervalPiece,secsIntervalPiece);var bb=aj(hoursRestPiece,minsRestPiece,secsRestPiece);var bd=aj(hoursDistPiece,minsDistPiece,secsDistPiece);var bf={Session_ID:"User Defined",_id:"123456",PieceType:"TIME",PieceTime:a9,HeartRate:hrTarget,StrokeRate:stkTarget};bc.push(bf);var ba=parseInt(pieceDistanceSelected);var be={Session_ID:"User Defined",_id:"234567",PieceType:"DISTANCE",Distance:ba,HeartRate:hrTarget,StrokeRate:stkTarget};bc.push(be);var a7={Session_ID:"User Defined",_id:"234567",PieceType:"INTERVAL SET",IS_Interval:l,IS_Rest:bb,IntervalType:"Time",RestType:"Time",IS_Repeat:repeatTime};bc.push(a7);var a6={Session_ID:"User Defined",_id:"234567",PieceType:"INTERVAL SET",IS_Interval:distInterval,IS_Rest:bd,IntervalType:"Distance",RestType:"Time",IS_Repeat:distRest};bc.push(a6);var a5={Session_ID:"User Defined",_id:"234567",PieceType:"INTERVAL SET",IS_Interval:strokeInterval,IS_Rest:strokeRest,IntervalType:"Stroke",RestType:"Stroke",IS_Repeat:strokeRepeat};bc.push(a5);return bc}function aj(l,a6,a7){var a5;a5=l*60*60*1000+a6*60*1000+a7*1000;return a5}var X=100,aP=0;var p=0,B=0,aF=0,aw=0,E=0,ad=0,v=0,K=0,D=0,aV="",u="",ae="",au="",k=0,U=0;var aL=100;var aB=10;var aY=0;var T=0;var M;var a=0,aO=0,a2=0,aS=0,ap=0,a1=false;var aJ=aG("#time"),aa=aG("#distanceTraveled"),ak=aG("#strokeRate"),i=aG("#strokeCount"),aN=aG("#stroke"),aK=aG("#split"),n=aG("#heartRate"),c=aG("#splitTarget"),O=aG("#locAccuracy");var S=false,G=false;var z=aG("#timeElement").is(":visible");aG("#progressbar").progressbar({disabled:true});aG("#intervalContainer").hide();aG("#strokeElement").hide();aG("#stopinterval").click(function(l){l.stopPropagation();l.preventDefault();clearInterval(M)});document.addEventListener("deviceready",A,false);function A(){txData.connectionState();if(typeof device!="undefined"){var l=device.platform;if(l=="iOS"){aG("#hideExit").hide()}else{aG("#hideExit").show()}}}function r(l){}aG("#login").on("click",function(l){l.stopPropagation();l.preventDefault();ay()});aG("#startapp").on("click",function(a7){var a8=aG("#emailUser").val();var a5=aG("#passwordUser").val();a7.stopPropagation();a7.preventDefault();if(a5!=""){ay()}else{if(navigator.notification){navigator.notification.confirm("Do you wish to proceed Unregistered ?",a6,"Notice",["Yes","No"])}else{var l=confirm("Do You wish to proceed Unregistered");if(l){a6(1)}}}function a6(a9){if(a9==1){setDemoPieceValues();setPhoneSessionValues();aG.mobile.navigate("#NotReg")}}});aG(document).keypress(function(l){if((l.which==13)&&(statusItem.onStartPage==true)){ay()}});function ay(){aG("#session_div").empty();aG.mobile.showPageLoadingMsg("e","Please Wait Retrieving your Details \nAre you on-line...");cData.checkSameDay();var a6=cData.getSubscriptionHtml();aG("#constraintmsg").html(a6);aG("#demouser").hide();aG("#subscribeduser").show();G=txData.connectionState();dataItem.UsrType="Reg";var a7=aG("#emailUser").val();if(a7){dataItem.emailUsr=a7}else{dataItem.emailUsr="UnRegistered"}rData.setUserEM(dataItem.emailUsr);var a5=aG("#passwordUser").val();var l=al(a5);rData.setUserSecret(l);if(G){az();ar()}else{e(true)}aG("#passwordUser").val("")}function e(a8){aG("#session_div").empty();aG("#controlBtns").empty();var be="userid"+rData.getUserEM();var a6=aG.jStorage.get(be);var bd=rData.getUserSecret();if(a6){if(a6.userPwd==bd){rData.setUserID(a6.userID);rData.setDeveloperMode(true)}else{dataItem.emailUsr="UnRegistered";rData.setUserEM(dataItem.emailUsr);rData.setUserID(0);if(navigator.notification){navigator.notification.alert("Cant Verify who you are \nCheck logon Details and try again\nLeave password Blank for Unregistered user ",f,"Sorry","Ok")}else{alert("Cant Verify who you are Check email and password and try again")}aG.mobile.hidePageLoadingMsg();var ba=aG("#sessions_data").html("");aD();return}if(a6.userBUp){var a5=a6.bUpDate;if(a5){var bf=new Date(a5);var bb=bf.getFullYear();var a7=bf.getUTCMonth();var bc=bf.getUTCDate();if(!a8){if(navigator.notification){navigator.notification.alert("From Conection made on  "+bc+"/"+a7+"/"+bb,f,"Showing Sessions","Ok")}else{alert("Showing Sessions from connection made on"+bc+"/"+a7+"/"+bb)}}}aG.mobile.loadingMessage="Loading in Progress";aG.mobile.showPageLoadingMsg("b","Loading ...");an(a6.userBUp);var bg=aC();an(bg);setTimeout(function(){aG.mobile.navigate("#mySession");aG.mobile.hidePageLoadingMsg()},500)}else{if(navigator.notification){navigator.notification.alert("No Sessions Stored",f,"Notice","Ok")}else{alert("No Sessions Stored")}aG.mobile.navigate("#mySession");var bg=aC();an(bg)}if(a6.isDeveloper==true){L(a6.isDeveloper)}else{L(false)}var l;if(a6.dateDownLoaded.length>0){var a9=cData.checklastDownLoad(a6.dateDownLoaded);if(a9){l=a6.constraint;if(l){cData.setAtlConstraint(l)}else{l=cData.getDefaultQuota();cData.setAtlConstraint(l)}}else{l=cData.getDefaultQuota();cData.setAtlConstraint(l)}}aG.mobile.navigate("#mySession")}else{l=cData.getDefaultQuota();cData.setAtlConstraint(l);dataItem.emailUsr="UnRegistered";rData.setUserEM(dataItem.emailUsr);rData.setUserID(0);if(navigator.notification){navigator.notification.alert("To Proceed Leave password blank... Cant verify who you are",a3,"Notice","Ok")}else{alert("To Proceed Leave password blank... Cant Verify Who You are");aG.mobile.navigate("#startpage")}aG.mobile.hidePageLoadingMsg()}var ba=aG("#sessions_data").html("");aD()}function a3(){aG.mobile.navigate("#startpage")}function az(){var a5="userid"+rData.getUserEM();var l=aG.jStorage.get(a5);if(l){if(l.isDeveloper==true){L(true)}else{L(false)}}else{L(false)}}function aH(l){}function ao(){if(navigator.notification){navigator.notification.alert("Please free up space\ndelete Entries in History",l,"Memory Full","Ok")}else{alert("Please free up space\nDelete Entries in History")}function l(){}}function h(l){if(l==3){aG("#server3").checkboxradio();aG("#server3").prop("checked",true).checkboxradio("refresh");aG("#server2").checkboxradio();aG("#server2").prop("checked",false).checkboxradio("refresh");aG("#server1").checkboxradio();aG("#server1").prop("checked",false).checkboxradio("refresh");statusItem.baseURL=statusItem.baseURL_3}else{if(l==2){aG("#server3").checkboxradio();aG("#server3").prop("checked",false).checkboxradio("refresh");aG("#server2").checkboxradio();aG("#server2").prop("checked",true).checkboxradio("refresh");aG("#server1").checkboxradio();aG("#server1").prop("checked",false).checkboxradio("refresh");statusItem.baseURL=statusItem.baseURL_2}else{aG("#server3").checkboxradio();aG("#server3").prop("checked",false).checkboxradio("refresh");aG("#server2").checkboxradio();aG("#server2").prop("checked",false).checkboxradio("refresh");aG("#server1").checkboxradio();aG("#server1").prop("checked",true).checkboxradio("refresh");statusItem.baseURL=statusItem.baseURL_1}}}function at(){if(navigator.notification){navigator.notification.confirm("Are you sure you want to Exit ?",a5,"Notice",["Cancel","Ok"])}else{var l=confirm("Are you Sure you want to Exit");if(l){a5(2)}else{a5(1)}}function a5(a7){if(a7==2){h(1);gData.clearWatches();aG.mobile.changePage("#startpage",{transition:"none",reverse:true,changeHash:true});var a6=device.platform;if(a6!="iOS"){navigator.app.exitApp()}}}}aG("#CreatePiece").on("click",function(){aG("#session_div").empty();aG("#controlBtns").empty();var a5="userid"+rData.getUserEM();var l=aG.jStorage.get(a5);if(!l){}else{if(l.userBUp){aG.mobile.showPageLoadingMsg("b","Loading ...");an(l.userBUp);var a6=aC();setTimeout(function(){aG.mobile.navigate("#mySession");aG.mobile.hidePageLoadingMsg()},500)}}var a6=aC();aG.mobile.showPageLoadingMsg("b","Loading ...");an(a6);setTimeout(function(){aG.mobile.navigate("#mySession");aG.mobile.hidePageLoadingMsg()},500)});aG(".exitApplication").on("click touchstart",function(l){l.stopPropagation();l.preventDefault();rData.setUserID(0);at()});aG("#appExit").on("click",function(l){l.stopPropagation();l.preventDefault();rData.setUserID(0);at()});aG("#defaultSession").on("click",function(){aD();aG("#controlBtns").empty();aG.mobile.changePage("#controlPage",{transition:"slideup",reverse:true,changeHash:true});dataItem.Piece_Id=txData.generateUUID();dataItem.Session_Id=txData.generateUUID();dataItem.TP_Id=txData.generateUUID()});aG("#clearData").on("click touchstart",function(a5){a5.stopPropagation();a5.preventDefault();var l=confirm("Storage Size"+aG.jStorage.storageSize()+" Do You Want To Clear");if(l){aG.jStorage.flush()}});aG("#changeSession").on("click",function(l){l.stopPropagation();l.preventDefault();if(statusItem.pieceState=="RUNNING"){if((aP==0)||(aP==1)||(aP==2)){rData.setGuiEvent("PEND")}else{rData.setGuiEvent("IEND");k=D;aG("#strokeElement").hide();aG("#timeElement").show()}statusItem.pieceState="STOP"}aG.mobile.changePage("#mySession",{transition:"none",reverse:true,changeHash:true})});function g(){aG(".cbpause").hide();aG(".cbplay").show();aG(".cbstop").hide();aG(".cbcont").hide()}function Z(){aG(".cbpause").hide();aG(".cbplay").hide();aG(".cbstop").hide();aG(".cbcont").hide()}function aD(){aG(".cbpause").hide();aG(".cbplay").show();aG(".cbstop").hide();aG(".cbcont").hide();rData.setStrokeCount(0)}aD();function j(l){aG(".cbplay").eq(l).hide();aG(".cbpause").eq(l).show();aG(".cbstop").eq(l).hide();aG(".cbcont").eq(l).show();aG.mobile.changePage("#dashboard",{transition:"none",reverse:true,changeHash:true})}function av(l){aG(".cbplay").eq(l).hide();aG(".cbstop").eq(l).show();aG(".cbpause").eq(l).hide();aG(".cbcont").eq(l).show();aG.mobile.showPageLoadingMsg("b","Paused ...",true)}function Q(l){aG(".cbplay").eq(l).hide();aG(".cbstop").eq(l).hide();aG(".cbcont").eq(l).show();aG(".cbpause").eq(l).show();ac({heading:"Cont",mode:"cancel"});aG("#dialog,#mask").fadeOut();aG.mobile.changePage("#dashboard",{transition:"none",reverse:true,changeHash:true})}function aW(l){aG(".cbplay").eq(l).show();aG(".cbstop").eq(l).hide();aG(".cbpause").eq(l).hide();aG(".cbcont").eq(l).hide();aG("#dialog,#mask").fadeOut();aG.mobile.changePage("#dashboard",{transition:"none",reverse:true,changeHash:true})}function I(l){aG(".cbplay").eq(l).hide();aG(".cbstop").eq(l).hide();aG(".cbpause").eq(l).hide();aG(".cbcont").eq(l).hide()}function Y(){dataItem.Piece_Id=txData.generateUUID();dataItem.paID=txData.generateUUID();dataItem.type="PA";rData.setPieceID(dataItem.Piece_Id);rData.setSessionID(dataItem.Session_Id);rData.setTrainingPlanID(dataItem.TP_Id);rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0)}function m(){if(navigator.notification){navigator.notification.alert("Please end The Previous Selected Piece Before Continuing.... ",N,"New Piece Selected","Ok")}else{alert("Please End Previous Selected Piece Before Continuing")}}aG(document).delegate("#mySession","pageshow",function(){if(statusItem.pieceState=="RUNNING"){statusItem.pieceState="STOP";aD()}});aG(".cbplay").eq(0).on("click",function(l){if(statusItem.pieceState=="RUNNING"){m()}else{Y();cData.setPieceDiveq(0);aG("#intervalContainer").hide();aG("#timeLegent").text("Time");aG("#distanceLegent").text("Distance");aG("#distanceTarget").text("");aG("#timeTarget").text("");if(!z){aG("#strokeElement").hide();aG("#timeElement").show()}statusItem.pieceState="RUNNING";rData.setGuiEvent("PSTR");aP=0;aX(aP);j(0)}});aG(".cbpause").eq(0).on("click",function(l){l.stopPropagation();l.preventDefault();rData.setGuiEvent("PAUSE");av(0);l.handled=true});aG(".cbcont").eq(0).on("click",function(l){l.stopPropagation();l.preventDefault();rData.setGuiEvent("CONT");Q(0)});aG(".cbstop").eq(0).on("click",function(l){l.stopPropagation();l.preventDefault();rData.setGuiEvent("PEND");statusItem.pieceState="STOP";dataItem.paID=0;rData.setPAID(dataItem.paID);aW(0)});aG("#dashboard").click(function(){aG.mobile.changePage("#controlPage",{transition:"none",changeHash:false})});aG("#Interval").click(function(){showDialogInterval({heading:"Restart",content:"",btnOptions:"extra"},R)});var w=null;var aE=statusItem.updateSessionTimer;var ax=false;document.addEventListener("deviceready",am,false);function am(){ax=false;document.addEventListener("pause",y,false);document.addEventListener("resume",ag,false)}function y(){if(w!=null){clearInterval(w);w=null;ax=false}}function ag(){var a5=aG.mobile.activePage.attr("id");ax=true;if(a5=="mySession"){if(statusItem.demoUser==false){ah();w=setInterval(function(){ah()},aE)}else{aG("#session_div").empty();var l=aC();an(l)}}}aG(document).delegate("#mySession","pageshow",function(){if(ax){if(statusItem.demoUser==false){ah()}else{aG("#session_div").empty();var l=aC();an(l)}}if(statusItem.demoUser==false){w=setInterval(function(){ah()},aE)}});aG(document).delegate("#mySession","pagehide",function(){if(w!=null){clearInterval(w);w=null;ax=true}});function ah(){var a6=txData.connectionState();if(a6){var a5=aG.jStorage.get("lst");if(a5!=null){if(a5.data!=null){if(a5.data._id!=null){V(a5.data._id)}else{}}else{}}else{if(navigator.notification){navigator.notification.alert("Please Log in to Check latest Sessions",l,"Message","Ok")}else{alert("Please Log in to Check latest Sessions")}}}else{e(false);setTimeout(function(){aG.mobile.hidePageLoadingMsg();aI();W();Y()},2000)}function l(){}}function ar(){var a5=aC();an(a5);var l=statusItem.baseURL+"/Mobile/",a8=aG("#emailUser").val(),a7=aG("#passwordUser").val(),a6=dataItem.appVers,a9=a8+"$"+a7+"$"+a6;l+=a9;aG.ajax({url:l,dataType:"jsonp",jsonpCallback:"_rowsage",cache:false,timeout:10000,success:function(bf){if(bf){rData.setUserID(bf._id);var be=new Date().toDateString();cData.setAtlConstraint(bf.constraints);if(bf.Developer){rData.setDeveloperMode(bf.Developer)}else{rData.setDeveloperMode(false)}var bc="userid"+rData.getUserEM();var bd={};bd.email=rData.getUserEM();bd.data=bf;var bb=aG.jStorage.storageAvailable();if(bb){aG.jStorage.set("lst",bd);var ba={};ba.userName=rData.getUserEM();ba.userPwd=rData.getUserSecret();ba.userID=rData.getUserID();ba.constraint=cData.getAtlConstraint();ba.dateDownLoaded=be;aG.jStorage.set(bc,ba)}else{ao()}ah();setTimeout(function(){aG.mobile.changePage("#mySession",{transition:"none",reverse:true,changeHash:true})},1000)}else{aG("#entryMessage").text("Check Credentials");setTimeout(function(){aG("#entryMessage").text("")},2000);aG("#popupDInvalid").popup();aG("#popupDInvalid").popup("open");var bg=setTimeout(function(){aG("#popupDInvalid").popup();aG("#popupDInvalid").popup("close")},4000)}},error:function(ba,bd,bb){aG.mobile.hidePageLoadingMsg();aG("#popupDNoConn").popup();aG("#popupDNoConn").popup("open");var bc=setTimeout(function(){aG("#popupDNoConn").popup("close")},10000);L(false);aG.mobile.changePage("#mySession",{transition:"none",reverse:true,changeHash:true})}}).done(function(){aG.mobile.hidePageLoadingMsg()})}function V(a6){var a8=statusItem.baseURL+"/SessionMobile/";var a5=new Date();var a9=a5.getTime();var l="$"+a9;a8+=a6;a8+=l;aG("#session_div").empty();var a7=aC();an(a7);aG.ajax({url:a8,dataType:"jsonp",jsonpCallback:"_rowsage",cache:false,timeout:30000,success:function(bc){var bb="userid"+rData.getUserEM();var ba=aG.jStorage.get(bb);if(ba){ba.isDeveloper=rData.getDeveloperMode();aG.jStorage.set(bb,ba)}if(bc.length==0){aG.mobile.showPageLoadingMsg("a","There are No Sessions Scheduled for Today ...",true);a7=aC();an(a7);setTimeout(function(){aG.mobile.hidePageLoadingMsg();aI();W();Y()},2000)}else{aG.mobile.showPageLoadingMsg("e","Loading please wait ...");var bd=aG("#sessions_data").html("");if(ba){ba.userBUp=bc;ba.bUpDate=new Date();aG.jStorage.set(bb,ba)}txData.syncFromWeb(bc);aG("#session_div").empty();an(bc);a7=aC();an(a7);setTimeout(function(){aG.mobile.hidePageLoadingMsg();aG.mobile.navigate("#mySession");aG.mobile.hidePageLoadingMsg()},500)}},error:function(ba,bc,bb){aG.mobile.hidePageLoadingMsg();aG.mobile.showPageLoadingMsg("a","Problem refresing session data\nHave you got creit ...",true);e(false);setTimeout(function(){aG.mobile.hidePageLoadingMsg()},1000)}})}function an(a5){aG("#intervalContainer").hide();aG("#strokeElement").hide();aG("#timeElement").show();var l='<div class="sessionDiv"><p>${S_Name}</p>							<hr>							<p>Plan :${TP_Name} </p>							<p>Date :${S_Date}</P><p>Time : ${S_Time}</p>							<p>${S_Mode} &nbsp; ${S_ModeBType}</p>							</div>';aG("#controlBtns").empty();aG.template("sessionList",l);aG.each(a5,function(a6,a7){dataItem.TP_Name=a7.TP_Name;dataItem.TP_Id=a7._id;dataItem.TP_Id_Save=dataItem.TP_Id;dataItem.TP_Description=a7.TP_Description;aG.each(a7.PlannedSession,function(a9,a8){dataItem.S_Name=a8.S_Name;dataItem.S_Date=a8.S_Date;dataItem.S_Time=H(a8.S_Time);dataItem.S_Mode=a8.S_Mode;dataItem.S_TrainingZone=a8.S_TrainingZone;dataItem.S_ModeBType=a8.S_ModeBType;dataItem.S_ModeBName=a8.S_ModeBName;dataItem.Session_Id=a8.Session_ID;dataItem.S_Description=a8.S_Description;statusItem.pieceState="Ready";aG.tmpl("sessionList",dataItem).appendTo("#session_div").click(function(){dataItem.Session_Id=a8.Session_ID;dataItem.TP_Id=a5[a6]._id;rData.setTrainingPlanID(dataItem.TP_Id);rData.setSessionID(dataItem.Session_Id);t(a5,a8,a6,a9);aG.mobile.showPageLoadingMsg("b","Loading ...");aG.mobile.loadPage("#controlPage",{prefetch:"true"});aG.mobile.changePage("#controlPage",{transition:"slidedown",reverse:true,changeHash:true})})})})}function t(a8,a5,a7,a6){aG("#controlBtns").empty();var l='<div class="pieceDiv"><h4>${pieceType}</h4>		<div>		<div class="cbstop"><img src="img/stopbutton100By100.png" /></div>		<div class="cbpause"><img src="img/pausebutton100By100.png" /></div>		<div class="cbplay"><img src="img/playbutton100By100.png" /></div>		<div class="cbcont"><img src="img/playbutton100By100.png" /></div>		</div>		<h4>${pieceDes}</h4></div>';aG.template("btnList",l);if(typeof(a5.Piece)=="undefined"){return}aG.each(a5.Piece,function(bf,bc){s(a8,a7,a6,bf);var bl=bc;if(bl.PieceType=="DISTANCE"){var be=aG.tmpl("btnList",dataItem).appendTo("#controlBtns").on("click",function bb(bp){bp.stopPropagation();bp.preventDefault();var bo=aG(this)});aG(".cbplay",be).on("click",function(bp){bp.stopPropagation();bp.preventDefault();var bo=aG(this).parent().parent().index()+1;if(statusItem.pieceState=="RUNNING"){m()}else{cData.setPieceDiveq(bo);aG("#timeTarget").text("");aG("#timeLegent").text("Time");aG("#distanceLegent").text("Distance *");aG("#distanceTarget").text(bl.Distance+"m");aG("#heartTarget").text(bl.HeartRate);aG("#strokeTarget").text(bl.StrokeRate);aG("#intervalContainer").hide();dataItem.Piece_Id=bl._id;dataItem.Session_Id=bl.Session_ID;rData.setTrainingPlanID(dataItem.TP_Id);rData.setPieceID(dataItem.Piece_Id);rData.setSessionID(dataItem.Session_Id);dataItem.paID=txData.generateUUID();dataItem.type="PD";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);statusItem.pieceState="RUNNING";aP=2;aL=parseInt(bl.Distance);ac({heading:"Piece Start in 5",mode:"go"});j(bo)}});aG(".cbpause",be).on("click",function(bp){bp.stopPropagation();bp.preventDefault();rData.setGuiEvent("PAUSE");var bo=aG(this).parent().parent().index()+1;av(bo)});aG(".cbcont",be).on("click",function(bp){bp.stopPropagation();bp.preventDefault();rData.setGuiEvent("CONT");var bo=aG(this).parent().parent().index()+1;Q(bo)});aG(".cbstop",be).on("click",function(bp){bp.stopPropagation();bp.preventDefault();statusItem.pieceState="STOP";rData.setGuiEvent("PEND");dataItem.paID=0;dataItem.type="";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);var bo=aG(this).parent().parent().index()+1;aW(bo)})}else{if(bl.PieceType=="TIME"){var bm=aG.tmpl("btnList",dataItem).appendTo("#controlBtns").on("click",function bd(bo){});aG(".cbplay",bm).on("click",function(bp){bp.stopPropagation();bp.preventDefault();if(statusItem.pieceState=="RUNNING"){m()}else{aG("#timeLegent").text("Time *");aG("#distanceLegent").text("Distance");aG("#distanceTarget").text("");aG("#timeTarget").text(H(parseInt(bl.PieceTime)));aG("#heartTarget").text(bl.HeartRate);aG("#strokeTarget").text(bl.StrokeRate);aG("#intervalContainer").hide();rData.setTrainingPlanID(dataItem.TP_Id);rData.setPieceID(bl._id);rData.setSessionID(bl.Session_ID);dataItem.Piece_Id=bl._id;dataItem.Session_Id=bl.Session_ID;dataItem.paID=txData.generateUUID();dataItem.type="PT";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);var bo=aG(this).parent().parent().index()+1;cData.setPieceDiveq(bo);statusItem.pieceState="RUNNING";aP=1;p=(parseInt(bl.PieceTime));ac({heading:"Piece Start in 5",mode:"go"});j(bo)}});aG(".cbpause",bm).on("click",function(bp){bp.stopPropagation();bp.preventDefault();rData.setGuiEvent("PAUSE");var bo=aG(this).parent().parent().index()+1;av(bo)});aG(".cbcont",bm).on("click",function(bp){bp.stopPropagation();bp.preventDefault();rData.setGuiEvent("CONT");var bo=aG(this).parent().parent().index()+1;Q(bo)});aG(".cbstop",bm).on("click",function(bp){bp.stopPropagation();bp.preventDefault();statusItem.pieceState="STOP";rData.setGuiEvent("PEND");dataItem.paID=0;dataItem.type="";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);var bo=aG(this).parent().parent().index()+1;aW(bo)})}else{if(bl.PieceType=="STROKE"){var bh=aG.tmpl("btnList",dataItem).appendTo("#controlBtns").on("click",function bj(bp){bp.stopPropagation();bp.preventDefault();var bo=aG(this);aP=6;rData.setPieceID(bl._id);rData.setSessionID(bl.Session_ID);dataItem.Piece_Id=bl._id;dataItem.Session_Id=bl.Session_ID});aG(".cbplay",bh).on("click",function(bp){bp.stopPropagation();bp.preventDefault();var bo=aG(this).parent().parent().index()+1;if(statusItem.pieceState=="RUNNING"){m()}else{cData.setPieceDiveq(bo);aG("#distanceTarget").text("");aG("#timeTarget").text("");dataItem.paID=txData.generateUUID();dataItem.type="PS";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);statusItem.pieceState="RUNNING";aP=6;aB=bl.PT_Stroke;ac({heading:"Piece Start in 5",mode:"go"});j(bo)}});aG(".cbpause",bh).on("click",function(bp){bp.stopPropagation();bp.preventDefault();rData.setGuiEvent("PAUSE");var bo=aG(this).parent().parent().index()+1;av(bo)});aG(".cbcont",bh).on("click",function(bp){bp.stopPropagation();bp.preventDefault();rData.setGuiEvent("CONT");var bo=aG(this).parent().parent().index()+1;Q(bo)});aG(".cbstop",bh).on("click",function(bp){bp.stopPropagation();bp.preventDefault();statusItem.pieceState="STOP";rData.setGuiEvent("PEND");dataItem.paID=0;dataItem.type="";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);var bo=aG(this).parent().parent().index()+1;aW(bo)})}else{if((bl.PieceType=="INTERVAL SET")&&(bl.IntervalType=="Time")){var bn=aG.tmpl("btnList",dataItem).appendTo("#controlBtns").on("click",function bi(bp){bp.stopPropagation();bp.preventDefault();var bo=aG(this)});aG(".cbplay",bn).on("click",function(bp){bp.stopPropagation();bp.preventDefault();if(statusItem.pieceState=="RUNNING"){m()}else{dataItem.Piece_Id=bl._id;dataItem.Session_Id=bl.Session_ID;rData.setTrainingPlanID(dataItem.TP_Id);rData.setPieceID(bl._id);rData.setSessionID(bl.Session_ID);dataItem.paID=txData.generateUUID();dataItem.type="IT";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);aG("#timeLegent").text("Time");aG("#distanceLegent").text("Distance");aG("#intervalContainer").show();var bo=aG(this).parent().parent().index()+1;cData.setPieceDiveq(bo);aG("#distanceTarget").text("");statusItem.pieceState="RUNNING";aP=3;aZ(bl);setTimeout(function(){ac({heading:"Piece Start in 5",content:"",mode:"go"})},200);j(bo)}});aG(".cbpause",bn).on("click",function(bp){bp.stopPropagation();bp.preventDefault();rData.setGuiEvent("PAUSE");var bo=aG(this).parent().parent().index()+1;av(bo)});aG(".cbcont",bn).on("click",function(bp){bp.stopPropagation();bp.preventDefault();rData.setGuiEvent("CONT");var bo=aG(this).parent().parent().index()+1;Q(bo)});aG(".cbstop",bn).on("click",function(bp){bp.stopPropagation();bp.preventDefault();statusItem.pieceState="STOP";rData.setGuiEvent("IEND");dataItem.paID=0;dataItem.type="";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);var bo=aG(this).parent().parent().index()+1;k=D;aG("#strokeElement").hide();aG("#timeElement").show();aW(bo)})}else{if((bl.PieceType=="INTERVAL SET")&&(bl.IntervalType=="Distance")){var bg=aG.tmpl("btnList",dataItem).appendTo("#controlBtns").on("click",function ba(bp){bp.stopPropagation();bp.preventDefault();var bo=aG(this)});aG(".cbplay",bg).on("click",function(bp){bp.stopPropagation();bp.preventDefault();if(statusItem.pieceState=="RUNNING"){m()}else{aG("#timeLegent").text("Time");aG("#distanceLegent").text("Distance");aG("#intervalContainer").show();rData.setTrainingPlanID(dataItem.TP_Id);rData.setPieceID(bl._id);rData.setSessionID(bl.Session_ID);dataItem.Piece_Id=bl._id;dataItem.Session_Id=bl.Session_ID;dataItem.paID=txData.generateUUID();dataItem.type="ID";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);var bo=aG(this).parent().parent().index()+1;cData.setPieceDiveq(bo);statusItem.pieceState="RUNNING";aP=4;aZ(bl);setTimeout(function(){ac({heading:"Piece Start in 5",mode:"go"})},200);j(bo)}});aG(".cbpause",bg).on("click",function(bp){bp.stopPropagation();bp.preventDefault();rData.setGuiEvent("PAUSE");var bo=aG(this).parent().parent().index()+1;av(bo)});aG(".cbcont",bg).on("click",function(bp){bp.stopPropagation();bp.preventDefault();rData.setGuiEvent("CONT");var bo=aG(this).parent().parent().index()+1;Q(bo)});aG(".cbstop",bg).on("click",function(bp){bp.stopPropagation();bp.preventDefault();statusItem.pieceState="STOP";rData.setGuiEvent("IEND");dataItem.paID=0;dataItem.type="";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);var bo=aG(this).parent().parent().index()+1;k=D;aG("#strokeElement").hide();aG("#timeElement").show();aW(aY)})}else{if((bl.PieceType=="INTERVAL SET")&&(bl.IntervalType=="Stroke")){var bk=aG.tmpl("btnList",dataItem).appendTo("#controlBtns").on("click",function a9(bp){bp.stopPropagation();bp.preventDefault();var bo=aG(this)});aG(".cbplay",bk).on("click",function(bp){bp.stopPropagation();bp.preventDefault();var bo=aG(this).parent().parent().index()+1;if(statusItem.pieceState=="RUNNING"){m()}else{aG("#timeLegent").text("Time");aG("#distanceLegent").text("Distance");aG("#intervalContainer").show();aG("#distanceTarget").text("");rData.setTrainingPlanID(dataItem.TP_Id);rData.setPieceID(bl._id);rData.setSessionID(bl.Session_ID);dataItem.Piece_Id=bl._id;dataItem.Session_Id=bl.Session_ID;dataItem.paID=txData.generateUUID();dataItem.type="IS";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);cData.setPieceDiveq(bo);statusItem.pieceState="RUNNING";aP=5;aZ(bl);setTimeout(function(){ac({heading:"Piece Start in 5",mode:"go"})},200);j(bo)}});aG(".cbpause",bk).on("click",function(bp){bp.stopPropagation();bp.preventDefault();rData.setGuiEvent("PAUSE");var bo=aG(this).parent().parent().index()+1;av(bo)});aG(".cbcont",bk).on("click",function(bp){bp.stopPropagation();bp.preventDefault();rData.setGuiEvent("CONT");var bo=aG(this).parent().parent().index()+1;Q(bo)});aG(".cbstop",bk).on("click",function(bp){bp.stopPropagation();bp.preventDefault();statusItem.pieceState="STOP";rData.setGuiEvent("IEND");dataItem.paID=0;dataItem.type="";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);var bo=aG(this).parent().parent().index()+1;k=D;aG("#strokeElement").hide();aG("#timeElement").show();aW(bo)})}}}}}}});g()}function s(a8,a7,a6,a5){var l=a8[a7].PlannedSession[a6].Piece[a5];var a9=l.PieceType;if(a9=="DISTANCE"){dataItem.pieceTypeInt=1;dataItem.pieceType="Distance Piece";dataItem.pieceDes=l.Distance+" m"}else{if(a9=="TIME"){dataItem.pieceTypeInt=2;dataItem.pieceType="Timed Piece";dataItem.pieceDes=H(l.PieceTime)}else{if(a9=="INTERVAL SET"){dataItem.pieceType="Interval Set";if(l.IntervalType=="Distance"){dataItem.pieceTypeInt=3;dataItem.pieceDes=l.IS_Repeat+" X "+l.IS_Interval+" m "}else{if(l.IntervalType=="Time"){dataItem.pieceTypeInt=4;dataItem.pieceDes=l.IS_Repeat+" X "+H(l.IS_Interval)}else{if(l.IntervalType=="Stroke"){dataItem.pieceTypeInt=5;dataItem.pieceDes=l.IS_Repeat+" X "+l.IS_Interval+" strokes"}else{dataItem.pieceTypeInt=0;dataItem.pieceDes=l.IS_Repeat+" X "+l.IS_Interval}}}}else{dataItem.pieceTypeInt=0;dataItem.pieceType="not defined"}}}results.resultsDisply()}function aZ(l){aV=l.IntervalType;u=l.RestType;if(aV==="Time"){aF=(parseInt(l.IS_Interval));aG("#timeTarget").text(H(parseInt(l.IS_Interval)));aG("#time").text(H(parseInt(l.IS_Interval)))}else{if(aV==="Distance"){E=parseInt(l.IS_Interval);aG("#distanceTarget").text(l.IS_Interval+"m");aG("#timeTarget").text("")}else{if(aV==="Stroke"){a1=true;v=parseInt(l.IS_Interval);aG("#timeTarget").text("")}else{}}}if(u==="Time"){aw=(parseInt(l.IS_Rest))}else{if(u==="Distance"){ad=(parseInt(l.IS_Rest))}else{if(u==="Stroke"){K=parseInt(l.IS_Rest)}else{}}}D=(parseInt(l.IS_Repeat));k=D;J()}function W(){aG("#distanceTarget").text("");aG("#strokeTarget").text("");aG("#timeTarget").text("");aG("#heartTarget").text("");aG("#splitTarget").text("")}function aI(){aG("#time").text("0:00:00");aG("#distanceTraveled").text("0");aG("#heartRate").text("--");aG("#strokeCount").text("");aG("#split").text("--")}function d(){}function ac(l,a8,a7){var a5=aG("#dialog");var a6=aG.extend({heading:"",content:"",btnOptions:"none",mode:"go",restTime:10000,intervalTime:20000},l);a5.find(".heading").text(a6.heading);a5.find(".content").text(a6.content);aG("#dialog,#mask").fadeIn();if(l.mode==="go"){if((aP===1)||(aP===2)||(aP===6)){document.getElementById("time").innerHTML=H(p);setTimeout(function(){rData.setGuiEvent("PSTR")},4000)}else{}setTimeout(function(){a5.find(".heading").text("Piece Start in 4")},1000);setTimeout(function(){a5.find(".heading").text("Piece Start in 3")},2000);setTimeout(function(){a5.find(".heading").text("Piece Start in 2")},3000);setTimeout(function(){a5.find(".heading").text("Piece Start in 1")},4000);setTimeout(function(){aG("#dialog ,#mask").fadeOut();aX(aP)},4000)}if(l.mode==="cancel"){setTimeout(function(){aG("#dialog ,#mask").fadeOut()},2000)}if(l.mode==="quota"){setTimeout(function(){aG("#dialog ,#mask").fadeOut()},10000)}if(l.mode==="ISTime"){aG("#progressbar").progressbar("option","disabled",false);S=true;clearInterval(M);M=setInterval(function(){var ba=rData.getRestTimeTotal();var bb=ba/aw;aG("#progressbar").progressbar({value:bb*100});var a9=Math.round((aw-ba)/1000);if((bb>=0.5)&&(a9>=2)){a5.find(".heading").text("ReStart in "+a9+" sec")}if((bb>=0.95)&&(a9<2)){aG("#dialog ,#mask").fadeOut()}if(aw<=ba){S=false;clearInterval(M);aG("#dialog ,#mask").fadeOut();aG("#progressbar").progressbar({value:0});rData.setGuiEvent("ISTP");aX(aP);dataItem.paID=txData.generateUUID();rData.setPAID(dataItem.paID)}if(statusItem.pieceState=="STOP"){S=false;rData.setGuiEvent("IEND");dataItem.pieceState="READY";dataItem.paID=0;rData.setPAID(dataItem.paID);clearInterval(M);aG("#dialog ,#mask").fadeOut();aG("#progressbar").progressbar({value:0});aD()}},100)}if(l.mode==="ISDistance"){aG("#progressbar").progressbar("option","disabled",false);S=true;clearInterval(M);M=setInterval(function(){var bb=rData.getRestDistanceTotal();var ba=bb/ad;var a9=Math.round(ad-bb);aG("#progressbar").progressbar({value:ba*100});if((ba>=0.5)&&(a9>=10)){a5.find(".heading").text("ReStart in "+a9+" m")}if((ba>=0.95)&&(a9<10)){aG("#dialog ,#mask").fadeOut()}if(ad<=bb){clearInterval(M);S=false;aG("#dialog ,#mask").fadeOut();aG("#progressbar").progressbar({value:0});rData.setGuiEvent("ISTP");aX(aP);dataItem.paID=txData.generateUUID();rData.setPAID(dataItem.paID)}if(statusItem.pieceState=="STOP"){S=false;rData.setGuiEvent("IEND");dataItem.pieceState="READY";dataItem.paID=0;rData.setPAID(dataItem.paID);clearInterval(M);aG("#dialog ,#mask").fadeOut();aG("#progressbar").progressbar({value:0});aD()}},100)}if(l.mode==="ISCount"){aG("#progressbar").progressbar("option","disabled",false);S=true;clearInterval(M);M=setInterval(function(){var a9=rData.getRestStrokeCountTotal();var bb=a9/K;var ba=Math.round(K-a9);aG("#progressbar").progressbar({value:bb*100});if((bb>=0.5)&&(ba>=1)){a5.find(".heading").text("ReStart in "+ba+" stks")}if((bb>=0.95)&&(ba<1)){aG("#dialog ,#mask").fadeOut()}if(K<=a9){clearInterval(M);S=false;aG("#dialog ,#mask").fadeOut();aG("#progressbar").progressbar({value:0});rData.setGuiEvent("ISTP");aX(aP);dataItem.paID=txData.generateUUID();rData.setPAID(dataItem.paID)}if(statusItem.pieceState=="STOP"){clearInterval(M);S=false;rData.setGuiEvent("IEND");aG("#dialog ,#mask").fadeOut();aG("#progressbar").progressbar({value:0});dataItem.pieceState="READY";dataItem.paID=0;rData.setPAID(dataItem.paID);aD()}},100)}if(l.btnOptions==="none"){a5.find("#pauseDefault").hide();a5.find("#pauseOption").hide()}else{if(l.btnOptions==="default"){a5.find("#pauseDefault").hide();a5.find("#pauseOption").show()}else{a5.find("#pauseOption").hide();a5.find("#pauseDefault").show()}}a5.find("#pausedP").on("click",function(a9){a9.stopPropagation();a9.preventDefault();a5.find(".heading").text("Pause");a5.find("#pauseOption").show();a5.find("#pauseDefault").hide();rData.setGuiEvent("PAUS")});a5.find("#resumeP").on("click",function(a9){a9.stopPropagation();a9.preventDefault();if(S){a5.find(".heading").text("REST");a5.find("#pauseOption").hide();a5.find("#pauseDefault").show();rData.setGuiEvent("CONT")}else{aG("#dialog,#mask").fadeOut();rData.setGuiEvent("CONT")}});a5.find("#cancelP").on("click",function(a9){a9.stopPropagation();a9.preventDefault();aG("#dialog,#mask").fadeOut();if((aP==1)||(aP==2)){rData.setGuiEvent("PEND");aG("#pause").hide();aG("#go").show();aG("#mySession").removeClass("ui-disabled")}else{rData.setGuiEvent("IEND");k=D;aG("#strokeElement").hide();aG("#timeElement").show();aG("#pause").hide();aG("#go").show();aG("#mySession").removeClass("ui-disabled")}})}function aM(){aG("#dialog ,#mask").fadeOut()}function aR(){aG("#pause").show();aG("#go").hide()}function aU(){aG("#pause").hide();aG("#go").show();aG("#mySession").removeClass("ui-disabled")}function aT(){}function R(){aG("#id").hide()}function a4(){}function aX(a5){cData.setPieceTypeInt(a5);var l;if(a5===0){l=new Date();statusItem.keyID=dataItem.Piece_Id+"%"+l+"Â£";C()}else{if(a5===1){aa.text(0);l=new Date();statusItem.keyID=dataItem.Piece_Id+"%"+l+"Â£";dataItem.type="PT";rData.setTYPE(dataItem.type);rData.setIDX(0);ab(p)}else{if(a5===2){aJ.text("0:00:00");l=new Date();statusItem.keyID=dataItem.Piece_Id+"%"+l+"Â£";dataItem.type="PD";rData.setTYPE(dataItem.type);rData.setIDX(0);ai(aL)}else{if(a5===3){dataItem.type="IT";rData.setTYPE(dataItem.type);rData.setIDX(0);F("Time")}else{if(a5===4){dataItem.type="ID";rData.setTYPE(dataItem.type);rData.setIDX(0);F("Distance")}else{if(a5===5){dataItem.type="IS";rData.setTYPE(dataItem.type);rData.setIDX(0);F("StrokeCount")}else{}}}}}}}function C(){clearInterval(M);var a5=rData.getPieceDistanceTotal();var l=rData.getPieceTimeTotal();M=setInterval(function(){aJ.text(H(rData.getPieceTimeTotal()));aa.text(Math.abs(Math.round(a5-rData.getPieceDistanceTotal())));var a8=rData.getStrokeRate();if(a8>=0){ak.text(Math.round(a8))}else{ak.text("--")}i.text(rData.getPieceStrokeCountTotal());var a7=rData.getAccuracy();if(a7<geolocAccuracy){O.text(Math.round(rData.getAccuracy()))}else{O.text("--")}n.text(rData.getHeartRate());var a6=rData.getSplitTime();if(a6){a6=a6.toFixed(3)}else{a6=0}if(rData.getSpeed()!="--"){splitTime=rData.getSpeed().toFixed(2)*1000;splitTime=H(splitTime)}else{splitTime="--"}aK.text(splitTime);if(rData.getGuiEvent()=="PEND"){clearInterval(M);statusItem.pieceState="READY";aD()}else{if(statusItem.pieceState=="STOP"){clearInterval(M);statusItem.pieceState="READY";aD()}}if(rData.getPieceTimeTotal()>statusItem.paddleTimeLimit){if(navigator.notification){navigator.notification.alert("Your paddle session taken too Long",N,"Message","Ok")}else{alert("Your Paddle Session Taken too Long")}clearInterval(M);rData.setGuiEvent("PEND");dataItem.pieceState="READY";dataItem.paID=0;rData.setPAID(dataItem.paID);aD()}},100)}function N(){aG.mobile.changePage("#controlPage",{transition:"none",reverse:true,changeHash:true})}function ab(a5){clearInterval(M);var l=rData.getPieceDistanceTotal();M=setInterval(function(){var a8=rData.getPieceTimeTotal();var a6=parseInt(a5-a8);aJ.text(H(a6));aa.text(Math.abs(Math.round(l-rData.getPieceDistanceTotal())));var a9=rData.getStrokeRate();if(a9>=0){ak.text(Math.round(a9))}else{ak.text("--")}i.text(rData.getPieceStrokeCountTotal());var a7=rData.getAccuracy();if(a7<geolocAccuracy){O.text(Math.round(rData.getAccuracy()))}else{O.text("--")}n.text(rData.getHeartRate());if(rData.getSpeed()!="--"){splitTime=rData.getSpeed().toFixed(2)*1000;splitTime=H(splitTime)}else{splitTime="--"}aK.text(splitTime);if(a6<=0){rData.setGuiEvent("PEND");dataItem.paID=0;dataItem.type="";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);ac({heading:"Complete",mode:"cancel"});clearInterval(M);statusItem.pieceState="READY";aD()}else{if(statusItem.pieceState=="STOP"){clearInterval(M);statusItem.pieceState="READY";aD()}}},100)}function ai(a5){clearInterval(M);var l=rData.getPieceDistanceTotal();M=setInterval(function(){var a8=Math.abs(l-rData.getPieceDistanceTotal());var a6=parseInt(a5-a8);aJ.text(H(rData.getPieceTimeTotal()));aa.text(Math.round(a6));var a9=rData.getStrokeRate();if(a9>=0){ak.text(Math.round(a9))}else{ak.text("--")}i.text(rData.getPieceStrokeCountTotal());var a7=rData.getAccuracy();if(a7<geolocAccuracy){O.text(Math.round(rData.getAccuracy()))}else{O.text("--")}n.text(rData.getHeartRate());if(rData.getSpeed()!="--"){splitTime=rData.getSpeed().toFixed(2)*1000;splitTime=H(splitTime)}else{splitTime="--"}aK.text(splitTime);if(a6<=0){rData.setGuiEvent("PEND");dataItem.paID=0;dataItem.type="";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);ac({heading:"Complete",mode:"cancel"});clearInterval(M);statusItem.pieceState="READY";aD()}else{if(statusItem.pieceState=="STOP"){clearInterval(M);statusItem.pieceState="READY";aD()}}},100)}function P(l){rData.setGuiEvent(GUIEvent);clearInterval(M);var a5=rData.getPieceDistanceTotal();M=setInterval(function(){var a8=rData.getPieceStrokeCountTotal();var a6=parseInt(l-a8);aJ.text(H(rData.getPieceTimeTotal()));aa.text(Math.round(rData.getPieceDistanceTotal()));var a9=rData.getStrokeRate();if(a9>=0){ak.text(Math.round(a9))}else{ak.text("--")}i.text(rData.getPieceStrokeCountTotal());aN.text(a6);var a7=rData.getAccuracy();if(a7<geolocAccuracy){O.text(Math.round(rData.getAccuracy()))}else{O.text("--")}n.text(rData.getHeartRate());if(rData.getSpeed()!="--"){splitTime=rData.getSpeed().toFixed(2)*1000;splitTime=H(splitTime)}else{splitTime="--"}aK.text(splitTime);if(statusItem.pieceState=="STOP"){clearInterval(M);statusItem.pieceState="READY";aD()}else{if(a6<=0){rData.setGuiEvent("ISTP");dataItem.paID=txData.generateUUID();dataItem.type="";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);ac({heading:"Complete",mode:"cancel"});clearInterval(M);statusItem.pieceState="READY";aD()}}},100)}function F(a6){var l=new Date();statusItem.keyID=dataItem.Piece_Id+"%"+l+"Â£";if(a6==="Time"){rData.setGuiEvent("ISTR",k);k--;clearInterval(M);var a5=rData.getPieceDistanceTotal();M=setInterval(function(){var a9=rData.getIntervalTimeTotal();var a7=parseInt(aF-a9);aJ.text(H(a7));aa.text(Math.abs(Math.round(a5-rData.getPieceDistanceTotal())));var ba=rData.getStrokeRate();if(ba>=0){ak.text(Math.round(ba))}else{ak.text("--")}i.text(rData.getIntervalStrokeCountTotal());var a8=rData.getAccuracy();if(a8<geolocAccuracy){O.text(Math.round(rData.getAccuracy()))}else{O.text("--")}n.text(rData.getHeartRate());if(rData.getSpeed()!="--"){splitTime=rData.getSpeed().toFixed(2)*1000;splitTime=H(splitTime)}else{splitTime="--"}aK.text(splitTime);if(statusItem.pieceState=="STOP"){clearInterval(M);rData.setGuiEvent("IEND");dataItem.paID=0;dataItem.type="";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);k=D;statusItem.pieceState="READY";aD()}else{if(a7<=0){rData.setGuiEvent("ISTP");clearInterval(M);dataItem.paID=txData.generateUUID();rData.setPAID(dataItem.paID);if((k>=1)&&(u=="Time")){dataItem.type="RT";rData.setTYPE(dataItem.type);rData.setIDX(0);ac({heading:"Rest",content:"",mode:"ISTime",restTime:aw});J()}else{if((k>=1)&&(u=="Distance")){dataItem.type="RD";rData.setTYPE(dataItem.type);rData.setIDX(0);ac({heading:"Rest",content:"",mode:"ISDistance",restTime:ad});J()}else{if((k>=1)&&(u=="Stroke")){dataItem.type="RS";rData.setTYPE(dataItem.type);rData.setIDX(0);ac({heading:"Rest",content:"",mode:"ISCount",restTime:K});J()}else{rData.setGuiEvent("IEND");dataItem.paID=0;dataItem.type="";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);k=D;ac({heading:"Complete",mode:"cancel"},R);statusItem.pieceState="READY";aD()}}}}}},100)}else{if(a6==="Distance"){rData.setGuiEvent("ISTR",k);k--;clearInterval(M);M=setInterval(function(){var a9=rData.getIntervalDistanceTotal();var a7=parseInt(E-a9);aJ.text(H(rData.getIntervalTimeTotal()));aa.text(Math.round(a7));var ba=rData.getStrokeRate();if(ba>=0){ak.text(Math.round(ba))}else{ak.text("--")}i.text(rData.getIntervalStrokeCountTotal());var a8=rData.getAccuracy();if(a8<geolocAccuracy){O.text(Math.round(rData.getAccuracy()))}else{O.text("--")}n.text(rData.getHeartRate());if(rData.getSpeed()!="--"){splitTime=rData.getSpeed().toFixed(2)*1000;splitTime=H(splitTime)}else{splitTime="--"}aK.text(splitTime);if(statusItem.pieceState=="STOP"){clearInterval(M);rData.setGuiEvent("IEND");dataItem.paID=0;dataItem.type="";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);k=D;statusItem.pieceState="READY";aD()}else{if(a7<=0){rData.setGuiEvent("ISTP");dataItem.paID=txData.generateUUID();rData.setPAID(dataItem.paID);clearInterval(M);if((k>=1)&&(u=="Time")){dataItem.type="RT";rData.setTYPE(dataItem.type);rData.setIDX(0);ac({heading:"Rest",content:"",mode:"ISTime",restTime:aw});J()}else{if((k>=1)&&(u=="Distance")){dataItem.type="RD";rData.setTYPE(dataItem.type);rData.setIDX(0);ac({heading:"Rest",content:"",mode:"ISDistance",restTime:ad});J()}else{if((k>=1)&&(u=="Stroke")){dataItem.type="RS";rData.setTYPE(dataItem.type);rData.setIDX(0);ac({heading:"Rest",content:"",mode:"ISCount",restTime:K});J()}else{rData.setGuiEvent("IEND");dataItem.paID=0;dataItem.type="";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);aU();k=D;ac({heading:"Complete",mode:"cancel"},R);statusItem.pieceState="READY";aD()}}}}}},100)}else{if(a6==="StrokeCount"){rData.setGuiEvent("ISTR",k);aG("#timeElement").hide();aG("#strokeElement").show();k--;var a5=rData.getPieceDistanceTotal();clearInterval(M);M=setInterval(function(){var a9=rData.getIntervalStrokeCountTotal();var a7=parseInt(v-a9);aJ.text(H(rData.getIntervalTimeTotal()));aa.text(Math.abs(Math.round(a5-rData.getPieceDistanceTotal())));var ba=rData.getStrokeRate();if(ba>=0){ak.text(Math.round(ba))}else{ak.text("--")}i.text(rData.getIntervalStrokeCountTotal());var a8=rData.getAccuracy();if(a8<geolocAccuracy){O.text(Math.round(rData.getAccuracy()))}else{O.text("--")}n.text(rData.getHeartRate());aN.text(a7);if(rData.getSpeed()!="--"){splitTime=rData.getSpeed().toFixed(2)*1000;splitTime=H(splitTime)}else{splitTime="--"}aK.text(splitTime);if(statusItem.pieceState=="STOP"){clearInterval(M);rData.setGuiEvent("IEND");dataItem.paID=0;dataItem.type="";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);k=D;statusItem.pieceState="READY";aD()}else{if(a7<=0){rData.setGuiEvent("ISTP");dataItem.paID=txData.generateUUID();rData.setPAID(dataItem.paID);clearInterval(M);if((k>=1)&&(u=="Time")){dataItem.type="RT";rData.setTYPE(dataItem.type);rData.setIDX(0);ac({heading:"Rest",content:"",mode:"ISTime",restTime:aw});J()}else{if((k>=1)&&(u=="Distance")){dataItem.type="RD";rData.setTYPE(dataItem.type);rData.setIDX(0);ac({heading:"Rest",content:"",mode:"ISDistance",restTime:ad});J()}else{if((k>=1)&&(u=="Stroke")){dataItem.type="RS";rData.setTYPE(dataItem.type);rData.setIDX(0);ac({heading:"Rest",content:"",mode:"ISCount",restTime:K});J()}else{rData.setGuiEvent("IEND");dataItem.paID=0;dataItem.type="";rData.setPAID(dataItem.paID);rData.setTYPE(dataItem.type);rData.setIDX(0);aU();k=D;aG("#timeElement").show();aG("#strokeElement").hide();ac({heading:"Complete",mode:"cancel"},R);statusItem.pieceState="READY";aD()}}}}}},100)}}}}function J(){var l=(D-k+1);aG("#intervalContainer").show();if(aV=="Time"){ae=H(aF)}else{if(aV=="Distance"){ae=E+" m"}else{if(aV=="Stroke"){ae=v+" stks"}}}if(u=="Time"){au=H(aw)}else{if(u=="Distance"){au=ad+" m"}else{if(u=="Stroke"){au=K+" stks"}}}aG("#intervalLegent").text(l+" of "+D+"  -On- "+ae+"  -Rest- "+au)}function al(bj){var be=8;var bh=0;function bc(bk,bn){var bm=(bk&65535)+(bn&65535);var bl=(bk>>16)+(bn>>16)+(bm>>16);return(bl<<16)|(bm&65535)}function a8(bl,bk){return(bl>>>bk)|(bl<<(32-bk))}function a9(bl,bk){return(bl>>>bk)}function l(bk,bm,bl){return((bk&bm)^((~bk)&bl))}function a7(bk,bm,bl){return((bk&bm)^(bk&bl)^(bm&bl))}function ba(bk){return(a8(bk,2)^a8(bk,13)^a8(bk,22))}function a5(bk){return(a8(bk,6)^a8(bk,11)^a8(bk,25))}function bi(bk){return(a8(bk,7)^a8(bk,18)^a9(bk,3))}function bd(bk){return(a8(bk,17)^a8(bk,19)^a9(bk,10))}function a6(bl,bm){var by=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298);var bn=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225);var bk=new Array(64);var bA,bz,bx,bw,bu,bs,br,bq,bp,bo;var bv,bt;bl[bm>>5]|=128<<(24-bm%32);bl[((bm+64>>9)<<4)+15]=bm;for(var bp=0;bp<bl.length;bp+=16){bA=bn[0];bz=bn[1];bx=bn[2];bw=bn[3];bu=bn[4];bs=bn[5];br=bn[6];bq=bn[7];for(var bo=0;bo<64;bo++){if(bo<16){bk[bo]=bl[bo+bp]}else{bk[bo]=bc(bc(bc(bd(bk[bo-2]),bk[bo-7]),bi(bk[bo-15])),bk[bo-16])}bv=bc(bc(bc(bc(bq,a5(bu)),l(bu,bs,br)),by[bo]),bk[bo]);bt=bc(ba(bA),a7(bA,bz,bx));bq=br;br=bs;bs=bu;bu=bc(bw,bv);bw=bx;bx=bz;bz=bA;bA=bc(bv,bt)}bn[0]=bc(bA,bn[0]);bn[1]=bc(bz,bn[1]);bn[2]=bc(bx,bn[2]);bn[3]=bc(bw,bn[3]);bn[4]=bc(bu,bn[4]);bn[5]=bc(bs,bn[5]);bn[6]=bc(br,bn[6]);bn[7]=bc(bq,bn[7])}return bn}function bb(bn){var bm=new Array();var bk=(1<<be)-1;for(var bl=0;bl<bn.length*be;bl+=be){bm[bl>>5]|=(bn.charCodeAt(bl/be)&bk)<<(24-bl%32)}return bm}function bg(bl){bl=bl.replace(/\r\n/g,"\n");var bk="";for(var bn=0;bn<bl.length;bn++){var bm=bl.charCodeAt(bn);if(bm<128){bk+=String.fromCharCode(bm)}else{if((bm>127)&&(bm<2048)){bk+=String.fromCharCode((bm>>6)|192);bk+=String.fromCharCode((bm&63)|128)}else{bk+=String.fromCharCode((bm>>12)|224);bk+=String.fromCharCode(((bm>>6)&63)|128);bk+=String.fromCharCode((bm&63)|128)}}}return bk}function bf(bm){var bl=bh?"0123456789ABCDEF":"0123456789abcdef";var bn="";for(var bk=0;bk<bm.length*4;bk++){bn+=bl.charAt((bm[bk>>2]>>((3-bk%4)*8+4))&15)+bl.charAt((bm[bk>>2]>>((3-bk%4)*8))&15)}return bn}bj=bg(bj);return bf(a6(bb(bj),bj.length*be))}function af(a5){var a8=new Date(a5||Date.now()),a7=""+(a8.getMonth()+1),l=""+a8.getDate(),a6=a8.getFullYear();if(a7.length<2){a7="0"+a7}if(l.length<2){l="0"+l}return[a6,a7,l].join("-")}function H(a6){var a9=3600000;var bb=60000;var a8=1000;var ba=0;var a7=0;var a5=0;var l;if(a6>=a9){a5=Math.floor(a6/a9)}a6=a5>0?(a6-a5*a9):a6;if(a6>=bb){a7=Math.floor(a6/bb)}a6=a7>0?(a6-a7*bb):a6;if(a6>=a8){ba=Math.floor(a6/a8)}a6=ba>0?(a6-ba*a8):a6;if(a5>0){l=(a5>9?a5:"0"+a5)+":"}else{l="0:"}if(a7>0){l+=(a7>9?a7:"0"+a7)+":"}else{l+="00:"}if(ba>0){l+=(ba>9?ba:"0"+ba)}else{l+="00"}return l}(function aA(){var l;var a5=setInterval(function(){var a6=rData.getGuiEvent();if(a6=="PSTR"){aG("#stateDashboard").text("App : Piece Started");aG("#stateDash").text("Running")}else{if(a6=="PEND"){aG("#stateDashboard").text("App : Piece Finished");l=aG("#stateDash").text();if(l!="Done"){if(silentmode=="false"){navigator.notification.beep(1)}}aG("#stateDash").text("Done")}else{if(a6=="ISTR"){aG("#stateDashboard").text("App : Interval Started");aG("#stateDash").text("Running")}else{if(a6=="ISTP"){aG("#stateDashboard").text("App : Interval Rest");aG("#stateDash").text("Rest")}else{if(a6=="IEND"){aG("#stateDashboard").text("App : Interval Finished");l=aG("#stateDash").text();if(l!="Done"){if(silentmode=="false"){navigator.notification.beep(1)}}aG("#stateDash").text("Done")}else{if(a6=="PAUSE"){aG("#stateDashboard").text("App : Paused");aG("#stateDash").text("Paused")}else{if(a6=="CONT"){aG("#stateDashboard").text("App : Continue After Pause");aG("#stateDash").text("Running")}}}}}}}},500)})()})(jQuery);