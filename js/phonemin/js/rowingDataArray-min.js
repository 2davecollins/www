/* © Clarify Cloud Limited 2013, 2014
All Rights Reserved
No part of this material or any of its contents may be reproduced, copied, modified or adapted, without prior written consent from Clarify Cloud Limited.
*/
function RowDataLog(){var e=[];var h=[];var a=[];var b=0;function i(j,k){this.savedToCloud=j.getSavedToCloud();this.savedToLocal=j.getSavedToLocal();this.upLoadID=j.setUpLoadID();this.pieceComplete=false;this.userID=j.getUserID();this.trainingPlanID=j.getTrainingPlanID();this.sessionID=j.getSessionID();this.pieceID=j.getPieceID();this.startTime=j.getGuiEventTime();switch(k){case"PIECE":this.intervals=false;break;case"INTERVAL":this.intervals=true;this.intervalArray=[];this.restArray=[];break}}function g(j){var k={guiE:j.guiEvent,guiT:j.guiEventTime,logT:j.logTime,usID:j.userID,usEM:j.userEM,plID:j.trainingPlanID,seID:j.sessionID,piID:j.pieceID,paID:j.paID,idX:j.idX,type:j.type,stRt:j.strokeRate,stCt:j.strokeCount,htRt:j.heartRate,dist:j.distance,spd:j.speed,lat:j.lat,lon:j.lon,acc:j.accuracy,head:j.heading,webS:j.savedToCloud,locS:j.savedToLocal,upLoadID:j.upLoadID};return k}function d(j){return JSON.stringify(g(j))}function f(j){this.upLoadID=j.getUpLoadID();this.guiEvent=j.getGuiEvent();this.guiEventTime=j.getGuiEventTime();this.logTime=j.getLogTime();this.userID=j.getUserID();this.userEM=j.getUserEM();this.paID=j.getPAID();this.type=j.getTYPE();this.idX=j.getIDX();this.trainingPlanID=j.getTrainingPlanID();this.sessionID=j.getSessionID();this.pieceID=j.getPieceID();this.strokeRate=j.getStrokeRate();this.strokeCount=j.getStrokeCount();this.heartRate=j.getHeartRate();this.distance=j.getDistance();this.speed=j.getSplitTime();this.lat=j.getLat();this.lon=j.getLon();this.accuracy=j.getAccuracy();this.heading=j.getHeading();this.savingStatus=false}function c(j){this.upLoadID=j.getUpLoadID();this.sendingState=j.getSendingState();this.savedToWeb=j.setSavedToCloud()}this.addRowingDataElement=function(k){var j=new f(k);e.push(j)};this.returnDataLogArray=function(j){return e};this.returnDataUnSavedCloud=function(j,o){var l=0;var n=0;var k=[];var m=[];while(l<e.length&&n<=j){if(e[l].savedToCloud===false){e[l].savingUUID=o;m.push(g(e[l]));k.push(l);n++}l++}return m};this.markDataWebSaved=function(l){var j=0;var k=0;while(j<e.length){if(e[j].savingUUID==l){e[j].savedToCloud=true;k++;if(k==e.length){}}j++}};this.checkSize=function(){var l=0;var k=0;var j;while(k<e.length){if(e[k].savedToCloud===true){l++}if(l>=e.length){dataItem.syncComplete=true;j=true}else{j=false}k++;l++}return j};this.saveArrayStorage=function(l){var k={rowDataArray:e,savingStatus:h,savedToWeb:false,athleteId:e[0].userID};if(k.athleteId!=0){var j=$.jStorage.storageAvailable();if(j){$.jStorage.set(l,k)}else{navigator.notification.alert("Please free up space\ndelete Entries in History",m,"Memory Full","Ok")}}else{}function m(){}};this.setSavingStatus=function(m,j,k,l){this.sendingState=j;this.attempts=k;this.sentDate=l};this.getSavingStatus=function(){return this.savingStatus};this.addSavingStatus=function(j){var k=new f(j)};this.clearArray=function(){e.length=0};this.newPiece=function(k){var j=new i(rData,k);a.push(j)};this.intervalCompleted=function(k){if(rData.getPieceID()===a[a.length-1].pieceID){var j={intervalNumber:k,intervalDistance:rData.getIntervalDistanceTotal(),intervalTime:rData.getIntervalTimeTotal(),intervalStrokeCount:rData.getIntervalStrokeCountTotal(),intervalPausedTime:rData.getIntervalPausedTime()};a[a.length-1].intervalArray.push(j)}else{}};this.restCompleted=function(j){if(rData.getPieceID()===a[a.length-1].pieceID){var k={restNumber:j,restDistance:rData.getRestDistanceTotal(),restTime:rData.getRestTimeTotal(),restStrokeCount:rData.getRestStrokeCountTotal(),restPausedTime:rData.getRestPausedTime()};a[a.length-1].restArray.push(k)}else{}};this.pieceCompleted=function(){if(rData.getPieceID()===a[a.length-1].pieceID){a[a.length-1].pieceComplete=true;a[a.length-1].pieceCompletedTime=rData.getGuiEventTime();a[a.length-1].pieceDistance=rData.getPieceDistanceTotal();a[a.length-1].pieceStrokeCount=rData.getPieceStrokeCountTotal();a[a.length-1].pieceTime=rData.getPieceTimeTotal();a[a.length-1].piecePausedTime=rData.getPiecePausedTime()}else{}}};